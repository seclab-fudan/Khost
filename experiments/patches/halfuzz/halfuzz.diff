diff -rNu '--exclude=.git' hal-fuzz/setup.sh hal-fuzz-new/setup.sh
--- hal-fuzz/setup.sh	2026-01-30 16:57:44.597058111 +0800
+++ hal-fuzz-new/setup.sh	2026-01-30 16:41:32.017485979 +0800
@@ -1,4 +1,6 @@
-UNICORN_QEMU_FLAGS="--python=/usr/bin/python3" make
+UNICORN_QEMU_FLAGS="--python=/usr/bin/python3" AFL_NO_X86=1 make # afl-fuzz
+git clone https://github.com/AFLplusplus/AFLplusplus && git -C AFLplusplus checkout b89727bea903aec80
+UNICORN_QEMU_FLAGS="--python=/usr/bin/python3" AFL_NO_X86=1 make -C AFLplusplus afl-fuzz
 cd ./unicorn_mode
 ./build_unicorn_support.sh
 cd ..
diff -rNu '--exclude=.git' hal-fuzz/unicorn_mode/build_unicorn_support.sh hal-fuzz-new/unicorn_mode/build_unicorn_support.sh
--- hal-fuzz/unicorn_mode/build_unicorn_support.sh	2026-01-30 16:59:03.912911017 +0800
+++ hal-fuzz-new/unicorn_mode/build_unicorn_support.sh	2026-01-30 17:08:03.155764573 +0800
@@ -153,7 +153,10 @@
 patch -p0 <patches/wfi.diff || exit 1
 patch -R -p0 <patches/wfe.diff || exit 1
 
-cd "unicorn-1.0.1" && patch -p1 -R <../patches/halfuzz-expose-XPSR.diff && cd .. || exit 1
+cd "unicorn-1.0.1" || exit 1
+patch -p1 -R <../patches/halfuzz-expose-XPSR.diff || exit 1
+patch -p1 <../patches/unicorn.diff || exit 1
+cd .. || exit 1
 
 echo "[+] Patching done."
 
@@ -168,6 +171,7 @@
 
 echo "[*] Attempting to build Unicorn (fingers crossed!)..."
 
+UNICORN_QEMU_FLAGS="--python=/usr/bin/python2" make clean || exit 1
 UNICORN_QEMU_FLAGS="--python=/usr/bin/python2" make || exit 1
 
 echo "[+] Build process successful!"
diff -rNu '--exclude=.git' hal-fuzz/unicorn_mode/patches/unicorn.diff hal-fuzz-new/unicorn_mode/patches/unicorn.diff
--- hal-fuzz/unicorn_mode/patches/unicorn.diff	1970-01-01 08:00:00.000000000 +0800
+++ hal-fuzz-new/unicorn_mode/patches/unicorn.diff	2026-01-30 16:43:39.001684817 +0800
@@ -0,0 +1,44 @@
+diff -ruN unicorn-1.0.1-ori/qemu/tcg/aarch64/tcg-target.c unicorn-1.0.1/qemu/tcg/aarch64/tcg-target.c
+--- unicorn-1.0.1-ori/qemu/tcg/aarch64/tcg-target.c	2017-04-20 06:14:24.000000000 +0000
++++ unicorn-1.0.1/qemu/tcg/aarch64/tcg-target.c	2025-06-20 14:48:52.958670989 +0000
+@@ -999,7 +999,10 @@
+     TCGMemOp opc = lb->opc;
+     TCGMemOp size = opc & MO_SIZE;
+ 
+-    reloc_pc19(lb->label_ptr[0], s->code_ptr);
++    // reloc_pc19(lb->label_ptr[0], s->code_ptr);
++    const int type = (HOOK_EXISTS(s->uc, UC_HOOK_MEM_READ) || HOOK_EXISTS(s->uc, UC_HOOK_MEM_WRITE) || HOOK_EXISTS(s->uc, UC_HOOK_MEM_READ_AFTER)) ?
++                R_AARCH64_JUMP26 : R_AARCH64_CONDBR19;
++    patch_reloc(lb->label_ptr[0], type, (intptr_t)s->code_ptr, 0);
+ 
+     tcg_out_mov(s, TCG_TYPE_I64, TCG_REG_X0, TCG_AREG0);
+     tcg_out_mov(s, TARGET_LONG_BITS == 64, TCG_REG_X1, lb->addrlo_reg);
+@@ -1020,7 +1023,10 @@
+     TCGMemOp opc = lb->opc;
+     TCGMemOp size = opc & MO_SIZE;
+ 
+-    reloc_pc19(lb->label_ptr[0], s->code_ptr);
++    // reloc_pc19(lb->label_ptr[0], s->code_ptr);
++    const int type = (HOOK_EXISTS(s->uc, UC_HOOK_MEM_READ) || HOOK_EXISTS(s->uc, UC_HOOK_MEM_WRITE) || HOOK_EXISTS(s->uc, UC_HOOK_MEM_READ_AFTER)) ?
++                R_AARCH64_JUMP26 : R_AARCH64_CONDBR19;
++    patch_reloc(lb->label_ptr[0], type, (intptr_t)s->code_ptr, 0);
+ 
+     tcg_out_mov(s, TCG_TYPE_I64, TCG_REG_X0, TCG_AREG0);
+     tcg_out_mov(s, TARGET_LONG_BITS == 64, TCG_REG_X1, lb->addrlo_reg);
+@@ -1104,7 +1110,15 @@
+ 
+     /* If not equal, we jump to the slow path. */
+     *label_ptr = s->code_ptr;
+-    tcg_out_goto_cond_noaddr(s, TCG_COND_NE);
++    
++    /* Unicorn: fast path if hookmem is not enable */
++    //tcg_out_goto_cond_noaddr(s, TCG_COND_NE);
++    if (!HOOK_EXISTS(s->uc, UC_HOOK_MEM_READ) && !HOOK_EXISTS(s->uc, UC_HOOK_MEM_WRITE) && !HOOK_EXISTS(s->uc, UC_HOOK_MEM_READ_AFTER)){
++        tcg_out_goto_cond_noaddr(s, TCG_COND_NE);
++    } else {
++      /* If not equal, we jump to the slow path. */
++        tcg_out_goto_noaddr(s);
++    }
+ }
+ 
+ #endif /* CONFIG_SOFTMMU */
